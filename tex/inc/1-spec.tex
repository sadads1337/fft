\section{Спектрально-разностное моделирование распространения сейсмических волн в упругих средах}

В данной главе описана общая математическая модель для решения численной задачи о распространении
упругих волн в 2D неоднородных средах, которые возникают в результате воздействия источника,
расположенного непосредственно в самой исследуемой среде.

\subsection{Постановка задачи}
Исследование распространения упругих сейсмических волн в неоднородных средах будет проводится на 
основе 2D модели теории упругости с соответсвующими начальными и граничными условиями. (todo reference)

В качестве среды рассматривается изотропная 2D неоднородная среда, представляющая собой прямоугольник, размера $a \times b$, $a, b>0$,
одна из границ (плоскость $z = 0$) которого является свободной поверхностью.

Прямоугольная декартова система координат введена таким образом, чтобы ось $Oz$ была направлена вертикально вниз,
а ось $Ox$ лежала на свободной поверхности. (todo picture)

Задача будет записана в терминах вектора скоростей смещений $\vec{u}={(u, w)}^T$
и тензора напряжений $\vec{\sigma}=(\sigma_{xx}, \sigma_{xz}, \sigma_{zz})^T$ в следующем виде.

\begin{equation}
\label{eq:1}
\begin{dcases}
	\rho\frac{\partial{\vec{u}}}{\partial{t}}
	=\begin{bmatrix}
    \frac{\partial{}}{\partial{x}} & \frac{\partial{}}{\partial{z}} & 0 \\
    0 & \frac{\partial{}}{\partial{x}} & \frac{\partial{}}{\partial{z}}
	\end{bmatrix}
	\vec{\sigma} + f(x{,} z{,} t), \\
	\frac{\partial{\vec{\sigma}}}{\partial{t}}
	=\begin{bmatrix}
    (\lambda+2\mu)\frac{\partial{}}{\partial{x}} & \lambda\frac{\partial{}}{\partial{z}} \\
    \mu\frac{\partial{}}{\partial{z}} & \mu\frac{\partial{}}{\partial{x}} \\
    \lambda\frac{\partial{}}{\partial{x}} & (\lambda+2\mu)\frac{\partial{}}{\partial{z}}
	\end{bmatrix}
	\vec{u},
\end{dcases}
\end{equation}

Где $t$ - время, $u$, $w$ - компоненты скоростей смещений по $Ox$ и $Oz$ соотвественно.
Параметры $\lambda(x,z), \mu(x,z)$ - коэффициенты Ламе, удовлетворяющие соотношениям: $\lambda + 2\mu=\rho{v}_p^2$, $\mu=\rho{v}_s^2$, 
где $v_p$ - скорость распространения продольных волн, $v_s$ - скорость распространения поперечных волн,
а $\rho(x,z)>0, \forall x,z$ - плотность среды.

Граничные условия на свободной поверхности (плоскость $z = 0$) задаются в виде:

\begin{equation}
	\label{eq:2}
	\sigma_{xx}|_{z=0}=\sigma_{xz}|_{z=0}=0
\end{equation}

В качестве начальных условий, в момент времени $t=0$ положим:

\begin{equation}
\begin{dcases}
	\label{eq:3}
	u = w = 0, \\
	\sigma_{xx}|_{t=0}=\sigma_{xz}|_{z=0}=\sigma_{zz}|_{z=0}=0
\end{dcases}
\end{equation}

Также предполагается, что функция источника представима в виде $f(x,z,t)=f_xi+f_zk$,
где $i, k$ - единичные направляющие вектора соотвествующих координатных осей.

В случае точечного источника типа "центр давления", расположенного в среде, функция $f(x,z,t)$ примет вид $f(x,z,t)=\delta(x-x_0)\delta(z-z_0)f(t)$,
где $\delta$ -  дельта функция Дирака, а $x_0, z_0$ - координаты источника.

Представленная система уравнений, в совокупности с начальными и граничными условиями,
описывает распространения упругих волн в неоднородной среде с точечным истоником.

\subsection{Метод решения и вывод основых формул}
В отличии от работы (todo reference) метод расчета сейсмических полей для задачи (\ref{eq:1}-\ref{eq:3}) основан на альтернативном,
не столь популярном, как его конечно-разностные аналоги, спектрально-разностном подходе. Этот метод обладает высокой скоростью сходимости,
при достаточно гладких решениях исходной задачи, что позволяет получить решение сравнимое по точности со стандартным
конечно-разностным методом.

Рассмотрим следующие прямые преобразования фурье для функций $u$, $w$, $\sigma_{xx}$, $\sigma_{xz}$, $\sigma_{zz}$.
(todo написать про четность)

\begin{equation}
\begin{sqcases}
	\label{eq:4}
	\overline{u}_k = \int_0^b{u \cdot sin(kx)} dx = \int_0^b{u(x,z,t) \cdot sin(kx)} dx = \overline{u}_k(x,z,t), \\
	\overline{w}_k = \int_0^b{w \cdot cos(kx)} dx = \int_0^b{w(x,z,t) \cdot cos(kx)} dx = \overline{w}_k(x,z,t), \\
	\overline{p}_k = \overline{\sigma}_{xx}^k = \int_0^b{{\sigma}_{xx} \cdot cos(kx)} dx 
		= \int_0^b{{\sigma}_{xx}(x,z,t) \cdot cos(kx)} dx = \overline{{\sigma}}_{xx}^k(x,z,t), \\
	\overline{q}_k = \overline{\sigma}_{xz}^k = \int_0^b{{\sigma}_{xz} \cdot sin(kx)} dx 
		= \int_0^b{{\sigma}_{xz}(x,z,t) \cdot sin(kx)} dx = \overline{{\sigma}}_{xz}^k(x,z,t), \\
	\overline{s}_k = \overline{\sigma}_{zz}^k = \int_0^b{{\sigma}_{zz} \cdot cos(kx)} dx 
		= \int_0^b{{\sigma}_{zz}(x,z,t) \cdot cos(kx)} dx = \overline{{\sigma}}_{zz}^k(x,z,t)
\end{sqcases}
\end{equation}
Где полагаем, что $k=\frac{k\pi}{b}$.

2D cпектрально-разностный метод для решения задачи (\ref{eq:1}-\ref{eq:3}), основанный на объединении
конечно-разностного метода по $z$ координате и конечного преобразования Фурье по $x$ координате
наиболее подробно описан в работе (todo reference). Ниже приведем только основные выкладки.

Умножим каждое уравнение системы (\ref{eq:1}) на соответсвующую базисную $k$-функцию и проинтегрируем
по $x$, предполагая, что
$$
\frac{1}{\rho(x,z,t)} = \frac{\overline{\rho}_0}{2} + \sum_{l=1}^\infty{\overline{\rho}_l \cdot cos(lx)}
	= \frac{\overline{\rho}_0(0,z)}{2} + \sum_{l=1}^\infty{\overline{\rho}_l(l,z) \cdot cos(lx)}
$$
$$
(\lambda + 2 \mu)(x,z) = \frac{(\lambda + 2 \mu)_0}{2} + \sum_{l=1}^\infty{(\overline{\lambda} + 2 \overline{\mu})_l \cdot cos(lx)}
$$
$$
\mu(x,z) = \frac{\overline{\mu}_0}{2} + \sum_{l=1}^\infty{\overline{\mu}_0 \cdot cos(lx)}
$$

Использая формулу интегрирования по частям, формулу произведения тригонометрических функций, приводя подобные слагаемые, и замену \ref{eq:4}
Получим следующее соотношение.

\begin{longaligned}
\label{eq:5}
{}
&\int_0^b\frac{1}{\rho}\frac{\partial\sigma_{xx}}{\partial x}sin(kx)dx
=\int_0^b\frac{\partial\sigma_{xx}}{\partial x} \left( \frac{1}{\rho}sin(kx)dx \right) = \\
&=\underbrace{{\left[\sigma_{xx} \frac{1}{\rho} sin(kx) \right]}_0^b}_{=0} 
	- \int_0^b\sigma_{xx}\frac{\partial}{\partial x}\left[ \frac{1}{\rho}sin(kx)\right]dx =\\
&= - \int_0^b\sigma_{xx}\frac{\partial}{\partial x}\left[ 
	\left(\ \frac{\overline{\rho}_0}{2} + \sum_{l=1}^\infty{\overline{\rho}_l \cdot cos(lx)} \right)sin(kx)\right]dx =\\
&= - \int_0^b\sigma_{xx}\frac{\partial}{\partial x}\left[ 
	\frac{\overline{\rho}_0}{2}sin(kx) + \sum_{l=1}^\infty{\overline{\rho}_l \cdot cos(lx)} sin(kx)\right]dx =\\
&= - \int_0^b\sigma_{xx}\frac{\partial}{\partial x}\left[ 
	\frac{\overline{\rho}_0}{2}sin(kx) + \frac{1}{2}\sum_{l=1}^\infty{\overline{\rho}_l \cdot sin\left((k+l)x\right)} \right. +\\
		&\left.+ \frac{1}{2}\sum_{l=1}^\infty{\overline{\rho}_l \cdot sin\left((k-l)x\right)} \right]dx = \longalignedtag\\
&= - \int_0^b\sigma_{xx}\left[ 
	k\frac{\overline{\rho}_0}{2}cos(kx) + \frac{1}{2}\left(\sum_{l=1}^\infty{(k+l)\overline{\rho}_l \cdot cos\left((k+l)x\right)} \right.\right. +\\
		&\left.\left.+ \sum_{l=1}^\infty{(k-l)\overline{\rho}_l \cdot cos\left((k-l)x\right)}\right)\right]dx =\\
&= -k \overline{\sigma}_{xx}^k \frac{\overline{\rho}_0}{2} - \frac{1}{2}\left(
	\sum_{l=1}^\infty{(k+l)\overline{\rho}_l \cdot \overline{\sigma}_{xx}^{(k+l)}}
		+ \sum_{l=1}^\infty{(k-l)\overline{\rho}_l \cdot \overline{\sigma}_{xx}^{(k-l)}}\right) =\\
&= - \frac{1}{2} \cdot \left(
	\sum_{l=0}^\infty{(k+l)\overline{\rho}_l \cdot \overline{\sigma}_{xx}^{(k+l)}}
		+ \sum_{l=0}^\infty{(k-l)\overline{\rho}_l \cdot \overline{\sigma}_{xx}^{(k-l)}}\right) =\\
&= - \frac{1}{2} \cdot \left(
	\sum_{l=0}^\infty{(k+l)\overline{\rho}_l \cdot \overline{p}^{(k+l)}}
		+ \sum_{l=0}^\infty{(k-l)\overline{\rho}_l \cdot \overline{p}^{(k-l)}}\right)
\end{longaligned}

Аналогичным образом получаем оставшиеся соотношения.

\begin{longaligned}
\label{eq:6}
{}
&\int_0^b{\frac{1}{\rho}\frac{\partial\sigma_{xz}}{\partial z}sin(kx)dx} =\\
&= \frac{1}{2} \cdot \left(
	\sum_{l=0}^\infty{(k+l)\overline{\rho}_l \cdot \frac{\partial \overline{\sigma}_{xz}^{(k+l)}}{\partial z}} \right.+
		\left.+ \sum_{l=0}^\infty{(k-l)\overline{\rho}_l \cdot \frac{\partial\overline{\sigma}_{xz}^{(k-l)}}{\partial z}}\right) =\\
&= \frac{1}{2} \cdot \left(
	\sum_{l=0}^\infty{(k+l)\overline{\rho}_l \cdot \frac{\partial \overline{q}^{(k+l)}}{\partial z}}
		+ \sum_{l=0}^\infty{(k-l)\overline{\rho}_l \cdot \frac{\partial\overline{q}^{(k-l)}}{\partial z}}\right); \\
&\int_0^b{\frac{1}{\rho}\frac{\partial\sigma_{xz}}{\partial x}cos(kx)dx} =\\
&= \frac{1}{2} \cdot \left(
	\sum_{l=0}^\infty{(k+l)\overline{\rho}_l \cdot \overline{\sigma}_{xz}^{(k+l)}}
		+ \sum_{l=0}^\infty{(k-l)\overline{\rho}_l \cdot \overline{\sigma}_{xz}^{(k-l)}}\right) =\\
&= \frac{1}{2} \cdot \left(
	\sum_{l=0}^\infty{(k+l)\overline{\rho}_l \cdot \overline{q}^{(k+l)}}
		+ \sum_{l=0}^\infty{(k-l)\overline{\rho}_l \cdot \overline{q}^{(k-l)}}\right); \\
&\int_0^b{\frac{1}{\rho}\frac{\partial\sigma_{zz}}{\partial z}cos(kx)dx} = \longalignedtag\\
&= \frac{1}{2} \cdot \left(
	\sum_{l=0}^\infty{(k+l)\overline{\rho}_l \cdot \frac{\partial \overline{\sigma}_{zz}^{(k+l)}}{\partial z}}
		+ \sum_{l=0}^\infty{(k-l)\overline{\rho}_l \cdot \frac{\partial\overline{\sigma}_{zz}^{(k-l)}}{\partial z}}\right) =\\
&= \frac{1}{2} \cdot \left(
	\sum_{l=0}^\infty{(k+l)\overline{\rho}_l \cdot \frac{\partial \overline{s}^{(k+l)}}{\partial z}}
		+ \sum_{l=0}^\infty{(k-l)\overline{\rho}_l \cdot \frac{\partial\overline{s}^{(k-l)}}{\partial z}}\right); \\
&\int_0^b{(\lambda + 2 \mu) \frac{\partial u}{\partial x}cos(kx)dx} =\\
&= \frac{1}{2} \cdot \left(
	\sum_{l=0}^\infty{(k+l)(\overline{\lambda}_l + 2\overline{\mu}_l) \cdot \overline{u}^{(k+l)}}
		+ \sum_{l=0}^\infty{(k-l)(\overline{\lambda}_l + 2\overline{\mu}_l) \cdot \overline{u}^{(k-l)}}\right); \\
&\int_0^b{\lambda \frac{\partial w}{\partial z}cos(kx)dx}
= \frac{1}{2} \cdot \left(
	\sum_{l=0}^\infty{(k+l)\overline{\lambda}_l \cdot \frac{\partial\overline{w}^{(k+l)}}{\partial z}}
		+ \sum_{l=0}^\infty{(k-l)\overline{\lambda}_l \cdot \frac{\partial\overline{w}^{(k-l)}}{\partial z}}\right); \\
&\int_0^b{\lambda \frac{\partial u}{\partial z}sin(kx)dx}
= \frac{1}{2} \cdot \left(
	\sum_{l=0}^\infty{(k+l)\overline{\mu}_l \cdot \frac{\partial\overline{u}^{(k+l)}}{\partial z}}
		+ \sum_{l=0}^\infty{(k-l)\overline{\mu}_l \cdot \frac{\partial\overline{u}^{(k-l)}}{\partial z}}\right); \\
&\int_0^b{\mu \frac{\partial w}{\partial x}sin(kx)dx}
= -\frac{1}{2} \cdot \left(
	\sum_{l=0}^\infty{(k+l)\overline{\mu}_l \cdot \overline{w}^{(k+l)}}
		+ \sum_{l=0}^\infty{(k-l)\overline{\mu}_l \cdot \overline{w}^{(k-l)}}\right); \\
&\int_0^b{(\lambda + 2 \mu) \frac{\partial w}{\partial z}cos(kx)dx} =\\
&= \frac{1}{2} \cdot \left(
	\sum_{l=0}^\infty{(k+l)(\overline{\lambda}_l + 2\overline{\mu}_l) \cdot \frac{\overline{w}^{(k+l)}}{\partial z}}
		+ \sum_{l=0}^\infty{(k-l)(\overline{\lambda}_l + 2\overline{\mu}_l) \cdot \frac{\overline{w}^{(k-l)}}{\partial z}}\right); \\
&\int_0^b{\lambda \frac{\partial u}{\partial x}cos(kx)dx}
= -\frac{1}{2} \cdot \left(
	\sum_{l=0}^\infty{(k+l)\overline{\lambda}_l \cdot \overline{u}^{(k+l)}}
		+ \sum_{l=0}^\infty{(k-l)\overline{\lambda}_l \cdot \overline{u}^{(k-l)}}\right);
\end{longaligned}

Таким образом, используя (\ref{eq:5}) и (\ref{eq:6}), и обозначая $conv(x,y)_k = \sum_{l=0}^\infty(k-l)x^{(k-l)}y^l$, $corr(x,y)_k = \sum_{l=0}^\infty(k+l)x^{(k+l)}y^l$, можно привести исходную систему (\ref{eq:1}-\ref{eq:3}) к виду.

\begin{longaligned}
\label{eq:7}
{}
&\frac{\partial\overline{u}_k}{\partial t} = \frac{1}{2} \cdot \sum_{l=0}^\infty\left(
	-(k+l)\overline{\rho}_l\overline{p}^{(k+l)}
		-(k-l)\overline{\rho}_l\overline{p}^{(k-l)} + \right.\\
	&\left.+(k+l)\overline{\rho}_l\frac{\partial\overline{q}^{(k+l)}}{\partial z}
		+(k-l)\overline{\rho}_l\frac{\partial\overline{q}^{(k-l)}}{\partial z}\right)
		+ \overline{f}_x^k = \\
	&=\frac{1}{2} \cdot \left(
		-conv(\overline\rho, \overline{p})_k
			-corr(\overline\rho, \overline{p})_k
			+ conv(\overline\rho, \frac{\partial\overline{q}}{\partial z})_k 
			+ corr(\overline\rho, \frac{\partial\overline{q}}{\partial z})_k \right)
		+ \overline{f}_x^k = \\
	&=\frac{1}{2} \cdot \left(
		-sum(\overline\rho, \overline{p})_k
			+ sum(\overline\rho, \frac{\partial\overline{q}}{\partial z})_k \right)
		+ \overline{f}_x^k; \\
&\frac{\partial\overline{w}_k}{\partial t} = \frac{1}{2} \cdot \sum_{l=0}^\infty\left(
	(k+l)\overline{\rho}_l\overline{q}^{(k+l)}
		+(k-l)\overline{\rho}_l\overline{q}^{(k-l)} + \right.\\
	&\left.+(k+l)\overline{\rho}_l\frac{\partial\overline{s}^{(k+l)}}{\partial z} 
		+(k-l)\overline{\rho}_l\frac{\partial\overline{s}^{(k-l)}}{\partial z}\right) 
		+ \overline{f}_z^k= \\
	&=\frac{1}{2} \cdot \left(
		conv(\overline\rho, \overline{q})_k
			+corr(\overline\rho, \overline{q})_k
			+ conv(\overline\rho, \frac{\partial\overline{s}}{\partial z})_k
			+ corr(\overline\rho, \frac{\partial\overline{s}}{\partial z})_k \right)
		+ \overline{f}_z^k= \\
	&=\frac{1}{2} \cdot \left(
		sum(\overline\rho, \overline{q})_k
			+ sum(\overline\rho, \frac{\partial\overline{s}}{\partial z})_k \right)
		+ \overline{f}_z^k; \longalignedtag\\
&\frac{\partial\overline{p}_k}{\partial t} = \frac{1}{2} \cdot \sum_{l=0}^\infty\left(
	-(k+l)(\overline{\lambda}_l + 2\overline{\mu}_l)\overline{u}^{(k+l)}
		-(k-l)(\overline{\lambda}_l + 2\overline{\mu}_l)\overline{u}^{(k-l)} + \right.\\
	&\left.+(k+l)\overline{\lambda}_l\frac{\partial\overline{w}^{(k+l)}}{\partial z} 
		+(k-l)\overline{\lambda}_l\frac{\partial\overline{w}^{(k-l)}}{\partial z}\right) = \\
	&=\frac{1}{2} \cdot \left(
		-conv((\overline{\lambda}_l + 2\overline{\mu}_l), \overline{u})_k
			-corr((\overline{\lambda}_l + 2\overline{\mu}_l), \overline{u})_k + \right.\\
		&\left.+ conv (\overline\lambda, \frac{\partial\overline{w}}{\partial z})_k
			+ corr(\overline\lambda, \frac{\partial\overline{w}}{\partial z})_k \right) = \\
	&=\frac{1}{2} \cdot \left(
		sum((\overline{\lambda}_l + 2\overline{\mu}_l), \overline{u})_k
			+ sum(\overline\lambda, \frac{\partial\overline{w}}{\partial z})_k \right) ; \\
&\frac{\partial\overline{q}_k}{\partial t} = \frac{1}{2} \cdot \sum_{l=0}^\infty\left(
	+(k+l)\overline{\mu}_l\frac{\partial\overline{u}^{(k+l)}}{\partial z}
		+(k-l)\overline{\mu}_l\frac{\partial\overline{u}^{(k-l)}}{\partial z} + \right.\\
	&\left.-(k+l)\overline{\mu}_l\overline{w}^{(k+l)}
		-(k-l)\overline{\mu}_l\overline{w}^{(k-l)}\right) = \\
	&=\frac{1}{2} \cdot \left(conv(\overline\mu, \frac{\partial\overline{u}}{\partial z})_k
		+corr(\mu, \frac{\partial\overline{u}}{\partial z})_k - \right.\\
	&\left.- conv (\overline\mu, \overline{w})_k
		-corr(\overline\mu, \overline{w})_k \right) = \\
	&=\frac{1}{2} \cdot \left(
		sum(\overline\mu, \frac{\partial\overline{u}}{\partial z})_k
			- sum(\overline\mu, \overline{w})_k \right) ; \\
&\frac{\partial\overline{s}_k}{\partial t} = \frac{1}{2} \cdot \sum_{l=0}^\infty\left(
	(k+l)(\overline{\lambda}_l + 2\overline{\mu}_l)\frac{\partial\overline{w}^{(k+l)}}{\partial z} 
		+(k-l)(\overline{\lambda}_l + 2\overline{\mu}_l)\frac{\partial\overline{w}^{(k+l)}}{\partial z} + \right.\\
	&\left.+(k+l)\overline{\lambda}_l\overline{u}^{(k-l)}
		+(k-l)\overline{\lambda}_l\overline{u}^{(k-l)}\right) = \\
	&=\frac{1}{2} \cdot \left(+conv((\overline{\lambda}_l + 2\overline{\mu}_l), \frac{\partial\overline{w}}{\partial z})_k 
		+corr((\overline{\lambda}_l + 2\overline{\mu}_l), \frac{\partial\overline{w}}{\partial z})_k + \right.\\
	&\left.+ conv (\overline\lambda, \overline{u})_k 
		+corr(\overline\lambda, \overline{u})_k \right) = \\
	&=\frac{1}{2} \cdot \left(
		sum((\overline{\lambda}_l + 2\overline{\mu}_l), \frac{\partial\overline{w}}{\partial z})_k
			+ sum(\overline\lambda, \overline{u})_k \right) ; \\
\end{longaligned}

Начальные и граничные же условия примут вид.

\begin{equation}
\label{eq:8}
123 todo
\end{equation}

\subsubsection{Разностная схема для преобразованной задачи}
Новую, уже одномерную задачу (\ref{eq:7}-\ref{eq:8}), полученную из исходной постановки (\ref{eq:1}-\ref{eq:3}),
можно решать различными конечно-разностными методами. В данной работе в качестве разностной схемы для решения (\ref{eq:7}-\ref{eq:8})
была взята, хорошо себя зарекомендовавшая, конечно-разностная схема Верье.

todo описание сетки, описание схемы

todo описание формул обращения

\subsubsection{Фильтрация (+аппроксимация)}
todo

\clearpage