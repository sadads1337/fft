import init_env(int #fgnum, int #fgsize, name) as init_env;
import check_env(value #env, int #fgnum, int #size) as check_env;

import init_values(int #fgnum, int #fgsize, name) as init_values;
import check_values(value #values, int #fgnum, int #size) as check_values;

import calculate_one_step(value #prev_values, value #env, int #t_idx, name #values) as calculate_one_step;
import check_one_step(value #prev_values, value #values, value #env, int #t_idx, int #fgnum, int #fgsize) as check_one_step;

##const FG_SIZE 512
##const FG_COUNT 1
##const T_IDX_LIMIT 2

sub main()
{
	df env, values, last_iter;

	init_env($FG_COUNT, $FG_SIZE, env);
	check_env(env, $FG_COUNT, $FG_SIZE);

	init_values($FG_COUNT, $FG_SIZE, values[0]);
	check_values(values[0], $FG_COUNT, $FG_SIZE);

	while (int(it < $T_IDX_LIMIT)), it = 0 .. out last_iter
	{
		calculate_one_step(values[it], env, it, values[it + 1]);
		check_one_step(values[it], values[it + 1], env, it, $FG_COUNT, $FG_SIZE);
	}
}
